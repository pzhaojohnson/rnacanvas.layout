/**
 * @jest-environment jsdom
 */

import { arrange } from './arrange';

import { NucleobaseMock } from './NucleobaseMock';

import { parseDotBracket } from '@rnacanvas/base-pairs';

import { isFiniteNumber } from '@rnacanvas/value-check';

import { shuffled } from '@rnacanvas/utilities';

import * as fs from 'fs';

class StructureMock {
  static fromDotBracket(dotBracket) {
    let seq = [...dotBracket].map(() => new NucleobaseMock({ centerPoint: { x: 0, y: 0 } }));

    let basePairs = [...parseDotBracket(seq, dotBracket)];

    return [seq, basePairs];
  }
}

class Layout {
  constructor(targetBases) {
    this.targetBases = targetBases;
  }

  isValid() {
    return this.targetBases.every(b => {
      let centerPoint = b.getCenterPoint();

      return [centerPoint.x, centerPoint.y].every(isFiniteNumber);
    });
  }
}

/**
 * Some random structures to test.
 */
const randomStructures = [
  '...(((.....)))...',
  '.(((((....((((.((((((((((((......((((((.......)))))).......))))..((((.(((.(((.((((((....)))))).))).)))..))))(((((((((((((((((((((..(((..((((((((..(((.(((((((((......))).))))))(((((((((((.....((.(((((((...)))))))((((...)))).........)).....)))))))))))..)))..))))))))..)))...))))))).))))))((((((.(((.(((((((((...((.((((((((((((((....)))))))).))))))))...))))).)))).)))))))))((((((((....((((((((((((.(((((....)))))))))).)))))))...))))))))))))))))....))))))))))))(((.(((((..(((.(((...((((........)))).))).)))))))).)))....)))))((((....((((..((((....(((((((..(((.(((((((........))))..)))..))))))).)))))))..))))....))))',
  '....(((....(((.......)))...))).....',
  '..........(((((((((((..((.((.((.(((((((.((((....(((((......)))))...)))).))))))).)).)).)).)))))))))))(((((.((.(((((..(((((....)))))(((((.........((((((....((((....))))..))))))........)))))..(((((...(((((..........(((((..(((((((.(((((((((((((((...)))))..)))).((((.(((.((((.....))))))).))))..)))))))))))))..)))))....(((((((.((((......((((..((((((((....)))))))).....))))))))..)))).)))))))).)))))((((..((((((((((((((((.(((((((((((...(((((.(((((.....))))).)))))...)))).))))))).)))))))))).))))))..)))).....(((((((.((((.......)))))))))))((((((((((((((...(((((.((...)).))))).....)))))..))..))).))))...(((....((((.((((((((.(((....((((......))))....(((((((((((((((..((((((((((.(((....)))((((((....((((...(((........))))))).....(((((((((((..((((((((((....(((((...)))))..)))).(((((........))))).....)))))).)))))))))))(((((((.((.(((.(((.....(((((.....)))))....))).))))))))))))..((((.((......)).)))).....((((.((((.....(((((.....)))))....((((((...(((((((..((((..(((((((((((((.......(((((((.....(((((((...)))))))..))))))).((((((((...((...))...))))))))....)))))).((((((..(((((((((((....(((.(((((...((((.(((((..((.((.(((((...((((((((((((.....(((((((((((.(((((((....))))))).)))))))))))......)))..)))))))))....))))).)).)).)))))))))....))))))))....))))))))))).))))))..)))))))..)))).)))))))...))))))....)))))))).....(((...)))..))))))....))))))))))....)))))))))))))))))).))))..))))...))))....)))..))))))).)))))....',
  '...((((((..((((.............)))).....))))))..(((((((((...(((.(((((..((((((.((.....(((((...)))))..)).)))))).)))))..)))(((((((....((.((((((..((((..........((((.((((((..............))))))...))))..(((......)))..........))))..))))))))....((....((...(((((.((.....))....)))))...)).....))...)))))))(((((.((......)).)))))....)))))).)))(((..((((((((((....(((((..((.((((....((((....))))..))))))..)))))((((((((.......))))))))................(((((.((.(((.........))).))))))).((.(((((......)))))))..(((.....)))(((((((.((((((...)))))).....)))))))..(((.(((((.....((((((..(((.((((((((((...)))...))))))).)))..))))))(((.((.......)).))).((((((..............(((((((((..(((((((((..((.((.(((.(((......((((....))))...)))..))).)).))..(((((((((((((((((.(((..((((.((((......)))).)))).))).............((((..(((((((.((((....(((...)))...)))).)))))))))))...))))))).((((((((.......))))..))))..((.(((((((((((....((((..........((((.....)))).......(((((((((.(((....)))..))))))))).........(((((....)))))..(((((((...((((((..((((...........))))...(((...(((((((..((.((((((......))))))...))...)))).)))..)))..))))))...(((((((((.(((.(((((((.............(((((....(((....)))....)))))...(((((..((....)))))))))))))).)))))))((((.(((((.((((....(((((....)))))....)))).)))))))))...))))))))))))....))))....))).)))))))).))((.(((((....)))))))...)))))))))).....((((((((..(((((((((((((((.(((.(((...........(((((((............)))))))........((....))...)))))).))))).............((((((((((((((...)).)))))))...)))))....((((((...(((..((((((((((.(((.......))).))))..((((((......))))))((((..(((((....(((......)))...)))))..))))...)))))))))..)))))).....((((...)))).(((((((((..((..(((((((.((((((((((((.................)))..)))).)))))..))..)))))...))..))))..)))))...))))).)))))..)))....))))).((.((((....)))).))................((((((((.(((((((((.........................)))......))))))..))))))))...((((.(((....)))))))))))).))))..)))))).)))..(((...(((...(((((((((.......)))))))))..)))))).))))))............((((((((((((((............)))..))))))))))).((((((.((((((..(((..((((((((......))))).........((((((.(((........))))))))).........))).)))))))))..)))))).......((((((((((.((((((..((((.((.((((((((.........(((((((........))))))))))))))).))..))))...))))))........((((((((((...(((((..((.((.((((((...)))))))).))..)))))...)))............)))))))......))))))))))......))))).))).))))))))))..)))',
  '...((((((..((((.............)))).....))))))..((((((((((..(((.(((((..((((((.((.....(((((...)))))..)).)))))).)))))..)))..)........((.((((((..((((..........((((.((((((..............))))))...))))..(((......)))..........))))..))))))))........((((..............))))...........((((((......))))))..(((((............)))))....)))))).)))(((..((((((((((.....((((..(..((((....((((....))))..)))).)..)))).((((((((.......))))))))................(((((.((.(((.........))).))))))).((.(((((......))))))).............(((((((.((((((...)))))).....)))))))..(((.(((((.....((((((..(((.(((((((............))))))).)))..))))))(((.............))).....................(((((((((..(((((((((..((.((.(((..............................))).)).))..(((((((((((((((((.((...((((.((((......)))).))))..)).............((((..(((((((.((((....(((...)))...)))).)))))))))))...))))))).((((((((.......))))..))))..((.(((((((((((....((((..........((((.....)))).......(((((((((.((......))..)))))))))..........((((....))))...(((((((...((((((..((((...........))))...(((...(((((((..((.((((((......))))))...))...)))).)))..)))..))))))...((((((((..(((.(((((((.............(((((....(((....)))....)))))...(((((...(....).)))))))))))).))).)))((((.(((((.((((....(((((....)))))....)))).)))))))))...))))))))))))....))))....))).)))))))).))((.(((((....)))))))...)))))))))).....((((((((..(((((((((.(((((.(((.((((..........(((((((............)))))))........((....)).).)))))).))))).............(((((((((((((.....).)))))))...)))))....((((((.((......(((((((((.(((.......))).))))....((((......))))..((((..(((((....(((......)))...)))))..))))...))))).))...)))))).....((((...))))..((((.(((..............((((((((((((.................)))..)))).)))))..................)))...)))).....)))).)))))..)))....)))))...................................((((((((.(((((((((.........................)))......))))))..))))))))...((((.(((....)))))))))))).))))..)))))).)))........(((...(((((((((.......)))))))))..)))......................((((((((((((((............)))..)))))))))))........((((((..(((..((((((((......))))).........(((((.((((........))))))))).........))).)))))))))...............(((((((((...(((((..((((.((.((((((((.........(((((((........))))))))))))))).))..))))...))))).........((((((((((...(((((..((.((.((((((...)))))))).))..)))))...)))............))))))).......)))))))))......))))).))).))))))))))..)))',
  '..........((((((((((((.......(((((((((...............)))))))))....((((..((((............))))..)))).......))))))...)).))))',
  '(((((...(((..(((((.........(((.((((((......)))))).(((((.(((......))).))))).....))).........)))))..))).....(((((((((............)))))))))........(((.......)))..((((((((......((....))))))))))((((((.((((((((((((....(((((((...((((...(((....(((((((((....)))))))))..)))....((.((((((...))))))))..)))).)))))))......((((.....))))(((.....)))((((((((((((((((((.......)))))))..((((.((((...((.((((....)))))))))).)))).....((((.((((.....))))..))))(((((.....)))))....(((((.((((.................))))))))).....(((((((((.((......)).)))))))))....((((((((....((.(((.((((.....)))).))).)).....))))))))....))).))))))))(((............)))(((((((((((((((.(((((...(((((((....))))))).....((((((...((((((((((((((((..(((..(((.((((.((.((((....))))...))(((.(((((....))))).))))))).)))..)))..))))))(((.(((((((((......(((((..((.(((............)))))..))))))))))).)))...)))......)))))...))).)).....)))))).(((((..(((((.....)))))..)))))((((....)))).....(((((((..........((((((....(((..((....))..)))..(((......))).((((((....(((((....((.....))....)))))...))))))..)))))).........)))))))))))).....)))))))))).))))).))))......)))))))).......(((((.((((..((((.((((......))))))))...))))...))))).......(((((((((.........)))))))))........)))))).....)))))...',
  '.(((.((.((((((.(((((((..........(((....)))...(((((.(((...((((((..(((((((.....(((((((.((..........))......((((((((((((((((....)))))))).......(((((.((((.(((.((((..((((((((((.((((((....)))))).....))))))...))))..)))))))..)))).)))))....))))))))...))))))).......))))))).........))))))...(((((((.((.......((.........)).......)).))))))).....((((((((((...((.(((((((((....((((.......))))....(((..((((((......))))))..)))..........((((((.(((((((...(((((.((((...))))..)))))...)).)))))(((.((((((((((((...(((((..(((((((.....((((((....(((..((......))..)))))))))..))))))))))))...))))))))))))))).......((((((((((....((((((..((...((((.....))))...))..))))))....))))))))))..((((((.......((((((((((((....(((.(((((..((((((....(((..(((.((....)).))).)))....)))))).)))))...))).(((((((((((((....(((((.....((((.....))))...)))))........((..(((.(((......))))))..))))))).))))).))).....(((((((.....))))))))))))))))..((((.((((.(((((....)))))..))))))))))).......))))))....(((((.......)))))...))))))(((((.(((((.((.(((((((.((((..((((.((((((.((......)).))))))..)))).......((((((...((((((.(((.((......)).)))............(((((.((((......)))))))))((.....))(((((((.(((...)))))))))).....)))))).)))))).........((((((((...)))..)))))..(((((((...((.....))...)))))))..)))).))))))).)))))))...))))).))))))))).)).((((.(((......((((..(((..(((((....((((........)))))))))..)))..))))..))).))))...))))))))))(((((((((.............(((((....))))).(((((((.((((((..((((..((((.(((((.......)))))....((((((((..(((((...............)))))......((.((((....((((..(((((...((((..(((.((....((((...(((....((.........(((((...........(((((((..((((..(((.........)))..))))....)))))))............)))))(((((....))))).....))....)))...))))....(((..........))))).)))..))))..)).)))..)))).....(((((((.((...(((......)))....(((((...)))))....(((((((((((((.......)))))))).)))))......((((((...((((((............))))))..))))))..)).)))))))((((....))))...)))).))...........((((((((((...(((((.((((..(((((.....((.....))))))).)))).)))))...........)))))))))).(((.........)))..((((((((((((.......)))).)))))))).))))...)))).......))))..))))..)))))).)))))))((((.........((..((.((((..((((.((((.(((..((.(((((.(((.....)))))))).)).))).))))))))..)))).))..))..........((((.....)))).((((((...((((((..((((((((...((((....)))).....((..(((.(((((.((.....(((((((((((((.........))).......((((((.....((((....))))..))))))..))))))))))..((((((.(((....)))))))))..........)).))))))))..))(((((((((.((((.......((((((((..(((((.....))))).)).))))))...))))..)))))))))))))))))..))))))))))))))))...)).))))))).))).)))))..))))))).)))).....)).)).)))....',
  '.((..((.((((((.(((((((..........(((....)))...(((((.((....((((((...(((((..................................((((((((((((((((....)))))))).......(((((.((((.(((.((((..((((((((((.((((((....)))))).....))))))...))))..)))))))..)))).)))))....))))))))..................)))))..........))))))...(((((((.((...........................)).)))))))......................................................((..((((((......))))))..))............................(((((.((((...))))..)))))............((.((((((((((((...(((((..(((((((..(((..((.....))..)))......................))))))))))))...)))))))))))))).........((((.(((.....(((((.............................))))).....))).))))....................((((((....................((((((..........(......).....................))))))................................................................((..(((......))).))........................(((((((.....)))))))..)))))).............(((((....)))))..(((((......)))))............(((((.......))))).....................((..((((((.(((...((((.((((((.((......)).))))))..)))).......((((((...((((((.(((.((......)).)))............(((((.((((......)))))))))((.....))(((((((.(((...)))))))))).....)))))).)))))).........((((((((...)))..)))))..(((((((...((.....))...)))))))...))).))))))..))...........................((((..((......((((..(((..(((((....((((........)))))))))..)))..))))..))..))))...................................(((((....)))))..((((((.((((((...................................................................((((((..((....((..((((........((.......(((.((..(..((....))..)..)).)))......................((((((..((((..(((.........)))..))))....)))))).................((((((....))))))........................................))......))))..))..))..))))))................((........))....(((((...)))))....((((.((((((((.......))))))))..))))...............((((((............)))))).(((((.....((((.(((..................................((((((((((....(((..((((..(((((.....(.......)))))).))))..)))............)))))))))).(((.........)))..((((((((((((.......)))).))))))))......)))..)))).)))))..........)))))).))))))............(((((....((((..((((.((((.(((..((.(((((.(((.....)))))))).)).))).))))))))..))))...(((((.........((((.....))))......(((........)))........))))).....)))))........................(((((((((.(((.........))).......((((((.....((((....))))..))))))...)))))))))..((((((...........))))))..........................................................(((.....))).......................................................................)).)))))..))))))).)))).....)).))..))....',
  '.((((.(((.....(((.(((.((((((((((((((.((((((((......))).....(((((((((((((((((((((((........(((((((...(((((..(((((((((.......((((((...(((((....(((............))).....)))))..(((....))).)))))).))))))))))))))...)))..)))).......)))))).)))))))..)))))((((((((((((....(((((((((((((((.....))))).(((.((........)))))))))))))))....))))))).((((....)))).....)))))((((..((((((((((((......)).))))...))))))..))))(((.......))).(((((((((...............(((((((((......((((.((((.....)))))).)).)))))))))(((((...))))).......)))))))))..)))))......((((((((((...((((((.(((((((((..((.(((((..((.......))..))))).)).........)))))(((.(((((.((...(((..(((........))))))))))))).)))))))..(((((.....))))).))))))........))).))))))).))))).))))....)))))))))).)))..(((((((((((.(((((((......((((((............((((.((((.((((((...........)))).)).)))).)))).....((((((((...)))))).))))).)))..)))).)))..)))))....)))))).))).....))))))).(((...(((.....)))..)))..',
  '.((((.(((.....(((.(((.((((((((((((((.(((((((((...(((((((((((((..((((((((((((((((((.............((...(((((..(((((((((.......((((((...(((((........(..(((...))).).....)))))..(((....))).)))))).))))))))))))))...))..............)))))).)))))))..)))))................(((((((((((((((.....))))).(((.((.(.....))))))))))))))))........................................((((((((((((......))).)))...))))))..(((((((((......................((.((((....((....)).....((((((((..................(((........................................((((..............................)))).....((((..((.......))..)))).................)))..............)))).)))).)))).))............)))))))))(((((.....)))))..))))))).))))..)).))))....))))).))))....)))))))))).)))..(((((((((((.((.(((.........................((((.((((.((((((...........)))).)).)))).)))).....((((((((...)))))).))..........)))..))..)))))....)))))).))).....)))))))..((...(((.....)))..))...',
  '((.(((((......(((((..........((.(((((((........((((((..........)))))).(((.(((.((((((..........))))))))).)))...((((((((.....((((......)))))))))))).........(((((((....)))))))(((((((((((.........))))).))))))....((((((.....((((.....))))))))))...(((....((((((((...))))).)))....))).(((((......)))))..)))))))))..((((((((((((...))))...(((.(((....))).)))((((((((........))))))))..(((((((((((.............)).))))))))).((((((.((..((((((((((.....................)))))).)))).))..(((((....)))))...(((((((......))))))).((........)).((((....)))).(((((((....)))))))((((.((((..(((((((((.....((((...(((.......)))....))))(((((((((..........))))).))))..((((...))))..........(((((((...((((((((...)))))))))))))))..........((((((((((((.(((((((((((((((((((((....)))......)))))...))))))...))))))).........))))))))))))..............(((((((((........))))))))))))))))))....)))).))))((..(((((((((((........)))))))))))..))((((((.......(((((.((......)).)))))))))))..))))))..(((((((((((((((((((....)))))...)))))))...............)))))))..)))))))).((((((.............(((((......))))))))))).......))))).....)))))...)).......',
  '................................(((((((........((((((..........)))))).(((.(((.((((((..........))))))))).)))...((((((((....((((.....))))..)))))))).........(((((((....)))))))(((((((((((.........))))).))))))....((((((.....((((.....))))))))))...(((....((((((((...))))).)))....))).((((........))))..)))))))....((((((((...............((.(((....))).)).((((((((........))))))))..(((((((.(((.............)))..))))))).((((((.((..((((((((((.....................)))))).)))).))..(((((....)))))...(((((((......))))))).((........)).((((....)))).(((((((....)))))))((((.((((..(((((((((.................................(((.(((((..........)))))..)))..((((...))))..........(((((((...((((((((...)))))))))))))))..........((((((((((((...((((.((((((((((((((....)))......)))))...))))))....))))...........))))))))))))..............(((((((((........))))))))))))))))))....)))).))))....(((((((((((........)))))))))))....((((((.......(((((.((......)).)))))))))))..))))))..(((((((((((((((((((....)))))...)))))))...............)))))))..)))))))).((((((.............(((((......)))))))))))..................................',
  '.......((((..(((.((((.........)))).))).)))).((..........)).....',
  '.(((..(((......)))...))).(((.(((((...(((((((.....)))))))..((((((....))))))((((((.((((((((.((.((((((.....(((...((((((.(((..(((((....((((((.....(((((.(((((((..(((((((..((..((((.....)))).(((((((......))).))))((((((.......))))))......)).)))))))....)))))))..))))).....(((((((((....(((...(((((....))))).)))..)).))))))).)))).)).....)))))..)))...))))))......)))))))))..)).)))).))))(((((.(((..(((((...((.((....)).))...)))))((((((.....))))))((((.(((((((.....)))))))))))((((((.(((((............)))))))))))))))))))...))))))(((........))).))))))))(((.((((......)))).((((((.......)))))).....((((((((.((....))))))))))))).',
  '.........................(((.(((((...(((((((.....)))))))......................................................................................(((((.(((((((..(((((((......((((.....))))......................((((((.......)))))).........)))))))....)))))))..))))).....(((((((((....(((...((((......)))).)))..)).)))))))..................((((..((((.....)))).))))............................................................((((((.....))))))((((.(((((((.....)))))))))))(((((.((((((............))))))))))).................(((........))).))))))))......((......))....(((((.......)))))......((((((((.(......)))))))))....',
  '......(((((....((((((........))))))...((((((.((..(((.(((((..(((......)))..))))).))).)).))))))........(((......)))(((((..((((...((((....(((((........)))))....))))..(((((...))))).(((((((.....)))))))..))))..)))))....(((((((.....((((..........)))).....))))))).)))))((((((((..(((((.(((....))))))))............(((((((((((.(((.((((((((.((((.......))))..(((((((((((.((((((((............................)))))))).)))).((((((((((.....((((........)))).))))).)))))....((..(((...((.((((.((.((((((...........)))))).)))))).)).)))..)).(((((....)))))...))))))).....(((((((....)))))))..(((((((((((((((((...((.(((((...(((((.........)))))....))))).)).......(((((..(((((........))))).......))))).((.(((((.((..(((.....)))..)).))))).))...............(((((((((...((((((.....(((....))).)))))))))))))))...........)))))).))))((((((..((((...((((((((.((((....(((.(((...(((((((((...(((.((((((....(((((....))))).((((((..((...(((((((........)))))))....)).)).)))).......)).)))).)))...)))))))))))).))))))).))...))))))...))))..))))))((((((.......(((...)))........))))))....))))))).......((((..(((((....(((((............)))))....)))))...))))..((((((((....((.....)).....)))).)))).(((.........))).......((((.(((.........)))))))...........))))))))))).)))))))).))).....((((((...((((((((((((((((((......))))).)).))...)))))..))))....)))))).((((((((.((((((.......))).)))..))))))))........((((((((.(((((((.......))))))).........((.(((((..((((......)).))..)))))))((((((.(((((((..(((...)))..))))))).))))))..((((((((...)))).)))).))))))))........))))))))...........',
  '...............((((((........))))))......................((((.((.((.........((((..((((......))))..)))).......)))).))))(((((............(((((........))))))))))......((((...))))(((((((((.....))))))).))..............(((((((.....((((..........)))).....)))))))......((((((((..(((((.(((....))))))))...............((((((((.(((.((((((((.((((.......))))..(((((((.(((.((((((((............................)))))))).)))..((((((((((.....((((........)))).))))).)))))........(((...((.((((.((.((((((...........)))))).)))))).)).)))......((((....))))....))))))).....(((((((....)))))))..(((((((((((((((((..............(((((.........)))))..........................(((((........))))).............((.(((((.((..(((.....)))..)).))))).))...............(((((((((...((((((.....((......)).)))))))))))))))...........)))))).))))((((((..((((...((((((.(.((((....(((.(((...(((((((((...(((.(((((((.(...........).)))((((((.......((((((..........)))))).......)).))))..........)))).)))...)))))))))))).))))))).)....))))))...))))..))))))((((((.......((.....))........))))))....))))))).......((((..(((((....(((((............)))))....)))))...))))..(((.((((....((.....)).....))))..))).(((.........))).......((((.(((.........)))))))...........))))))))))).)))))))).............................(((((((......))))).)).(((((((((.((.....))..)))...((((((((.((((((.......)))).))..))))))))..))))))((((((((.(((((((.......))))))).........((.(((((..((((......)).))..)))))))((((((.(((((((...(.....)...))))))).))))))..((((((((...)))).)))).))))))))........))))))))...........',
  '...(((((.((((.......(((((.....))))).........((((.((....)).)))).(((...)))(((.((((((((.((.(((...((...((((((((((.(((((...)))))..)))......((.(((((((......((((((((.(((((((((.((((((((((((((((......(((((((.......))))))).))))))........(((.(((((..((((((...........((((.((((....)).))..))))(((((..........)))))..(((.(((.((((((..........))))))))).)))...((((((((.....((((......))))))))))))......((((((((((....))))))).)))..(((((((....(((((.((((((((.....((((((.....((((.....))))))))))...(((....((((((((...))))).)))....)))...(((((((........))))))).)).)))))).)))))...)))))))..))))))..))))).)))((((((((........))))))))..(((((((((((.............)).))))))))).)))))).((..((((((((((.....................)))))).)))).))..(((((....)))))...(((((((......))))))).........((((.((((....)))).(((((((....)))))))((((.((((..(((((((((.....((((...(((.......)))....))))(((((((((..........))))).))))..((((...))))..........(((((((...((((((((...)))))))))))))))..........((((((((((((.(((((((((((((((((((((....)))......)))))...))))))...))))))).........))))))))))))..............(((((((((........))))))))))))))))))....)))).))))((..(((((((((((........)))))))))))..))((((((.......(((((.((......)).)))))))))))..))))....(((((((((((((((((((....)))))...)))))))...............)))))))...)))).))))))))).............(((((......)))))(((((......((((....))))((((((.(((((((.((((((((...(((((..((.((....)))).))))).(((((((..(((((.((((.....))))..)))))........(((((((...(((((.........)))))))))))).((((((.........))))))..)))).)))...(((((....)))))))))))))..........((((((.........)))))).....(((((((((.(((((((((..(((((((........))))))))))).....)))))....((((((((((((...(((((.....(((((...)).)))......)))))))))))))....)))).......((((((((((((((.((((((((............(((......)))............)))))))).)).............((((((((((....(((((.........(((((....(((....)))....)))))))))).)))).))))))...((((((........)))))).....)))))))))))).....((((.((.((((((.....((((..((((......))))..))))..))).))))).))))..)))))))))......(((((........)))))...)))))))))))))......(((((((((.....)))))).))).((((((((((....((((((.....((((..........)))).....))))))((((((((((((.....(((((.(((....))))))))..............((((((.....))))))..))).)))))))))..((.((.((((.((......))))))))))...........)))))))))).....)))))........((((((((((.....((((........)))).))))).)))))........)))))))).((((.((.((((((...........)))))).)))))).((((..((...(((((....))))).))))))((((....(((((((....)))))))....))))..((((.(((.(((((....((((.((((((((((...((.(((.........))).)).))))))).....))).)).))...))))).))).))))...((.(((((.((..(((.....)))..)).))))).))..)))))))))....(((((((((...((((((.....(((....))).)))))))))))))))...((((.((((((.(((......))).))))))..))))...)))).))).)).))).)))))))))).))).))))))))).',
  '...((((..((((.......(((((.....)))))...........(..((....))..)............(((.((((((((.((..(.....................(((.....)))............((((((((........))))))))..............(((((((((((((.......((((((.......))))))..))))))........(((.(((((..((((((..........((((((...(((((((........((((((..........)))))).(((.(((.((((((..........))))))))).)))...((((((((....((((.....))))..)))))))).........(((((((....)))))))(((((((((((.........))))).))))))....((((((.....((((.....))))))))))...(((....((((((((...))))).)))....))).((((........))))..)))))))......))).)))..............))))))..))))).)))((((((((........))))))))..(((((((((((.............))).)))))))).)))))))((..((((((((((.....................)))))).)))).))..(((((....)))))...(((((((......)))))))..............((((....)))).(((((((....))))))).......((((((((............................))))))))..(((.(((((..........)))))..)))..((((...))))..........(((((((...((((((((...)))))))))))))))..........((((((((((((...((((.((((((((((((((....)))......)))))...))))))....))))...........))))))))))))..............(((((((((........)))))))))......((......))...((((((((((((((((((........)))))))))))....((((((.......(((((.((......)).))))))))))).(((((((..(((((((((((((((((((....)))))...)))))))...............)))))))......((((.((((((.............(((((......))))))))))).....))))........(((((.((((((((.((((((((...(((((..((.((....)))).))))).(((((((..(((((.((((.....))))..)))))..((((...)))).....(((((.........))))).....(((((((....)))))))........)))).)))...(((((....)))))))))))))((.....)).((((((.........)))))).....(((((((((.(((((((((..(((((((........))))))))))).....)))))....((((((((((((...(((((.....((((.....).)))......)))))))))))))....)))).......((((((((((((((.((((((((............(((......)))............)))))))).)).............((((((.........(((..........((((......((....))......)))).))).......))))))...((((((........)))))).....)))))))))))).....((((.((.((((((.....((((..((((......))))..))))..))).))))).))))..)))))))))......(((((........)))))...)))))))))))))......(((((((((.....))))))).)).((((((((((....((((((.....((((..........)))).....)))))).(((((((((((.....(((((.(((....))))))))..............((((((.....))))))..))).))))))))....(.((.((((.((......)))))))))............))))))))))....)))))))...((((((((((((((.....((((........)))).))))).)))))........(((((.((..((((......(((...((((..(((............((.((((((((((((((....)))))...............(((((((....))))))).....)))))))))..)).....))).)))).))).(((((((.(..(.(((.........))).).))))))))...(((((........))))).............((.(((((.((..(((.....)))..)).))))).))...)))).)).)))))....))))...((((((.....((......)).))))))..)))))))..........((((.(((......))).))))........................)..)))))))))).))).)))).)))).',
  '......(((((..(((.....)))..)))))...((((((.(((((((((((.....((((((((....(((((.(((((.((......)))).))))))))......((.(((.((((((((((..((((.........))))))).))))).))))).))......((.((.((.((((..(((......)))..)))))).)).))))))))))((((...(((..(((((...))))).)))..))))....((((((((((.(((...))).)))))).....)))))))).)))))))(((((((.....)))))))......((((((........)))))).........((((((((..................)))))))).((.(((((((((((((((..(((((((.(((.(((.(((....))).)))..))).)))))))..)))).((.(((.....))))).(((((((((((((((..((((...)))).)))).((((((.....(((((........))))).(((((((..((..(((.....)))))..))))))).))))))..(((((((((((((..(((((........((.((((((((((((.....)))))....((((....)))).))))))))))))))..))).))..))))))))...)))).)))))))..((((.........))))......((.((((.......((((......((((.....))))...((((((((((........)))))....))))))))).......)))).)).)))).))))))))).......(((((.....)))))(((((..(((((.((...)))))))..))))).....)))))).(((((...((((......))))((((((...........))))))......((((.((((............)))).))))...........)))))......((((((.((....)).))))))....',
  '.(((((.((((..(((.....)))..)))).....(((((.................((((((((....(((((.(((((.((......)))).)))))))).........(((.((((((((((..((((.........))))))).))))).))))).........((.((.((.((((..(((......)))..)))))).)).))))))))))((((...(((..(((((...))))).)))..))))....((((((((((.(((...))).)))))).....))))............(((((((.....)))))))......((((((........)))))).........((((((((..................)))))))).((.((((((((((..............................((((....)))).(((((((((.....((.(((.....))))).((((((.(((.((((..((((...)))).)))).((((((.....(((((........))))).(((((((..((..(((.....)))))..))))))).))))))..(((((..((((((..(((((...........(((((..(((((.....)))))....((((....))))...)))))..)))))..))).)))....)))))....)))..))))))......((.....................)).........))))))))).....................(((((........))))).............................))).)))))))))......((((((.....)))))).......((((........)))).............))))).))))).....(((......))).((((((...........))))))......((((.((((............)))).))))......................((((((..........))))))....',
  '((((((((.(((((.(((((.((((((...(((((.......))))).)))))).)))....(((.((((((....)))).)).)))(((((.......))))).((((.(((((((((.....))..(((((((((((((((..((((((.((((....((((((...(((((((......))))))).....))))))((((......)))).....((((((((...)))))))).......((((((((((.((((....(((((...)))))..)))).)))).......((..((((((.....))))))..))(((((((((((..(((((((((((((((((......)))...........))).)))))).((((((........((..((((((....))))))....))))))))...(((((((.((((((....)))..))).)))))))...(((((((......)))))))((((((((..(((...((((((((...((((((.....((((((.......))))))..))))))(((((.....))))).....((((((((.....))))))))(((((((.......)).)))))(((.(((((((((((((((((((((((....((((.((((((.(((((..(((..(((((....(((....)))..((((.((((.((((((((((((..((((.(((.....))).))))((((((((....)))).))))......((((((((((.......)).))).)).))))))))))))))))))).))))))).))..)))))).)).)))))))).))..(((((((....))))))).)))).)).)))).))).....(((.((.(((((((((.........))))))))).)).)))......))))))))))))).((((((((((((((....((((....)))).(((((....)))))...)))))))..))))))).....(((((.......)))))..(((.((((((((((((.........)))....))))))))).)))))))))))(((.....)))..(((((((..........))))))).........(((((((((((((.......)).)))))))....))))........(((((....(((((.......))))).....))))))))..))))))))))))))))))).)))))..(((........))).))))))...)))).)))))).))...)))))))))).))).....))))))))).)))).))))).))))))))((((((....(((((.....((((((((......)))).))))))))).))))))(((.....)))...........',
  '(((((..((.((((((..........))))))..)))))))...........((((((.((((((((...(((((....))))).............(((((.((((((...((((.(((..(((....))).((((((......))))))(((((.....)))))((((((((...))))))))....)))))))..(((((.((.(((..((((((.((((((............)))))).))))))))).)).)))))......))).)))..))))).....))))))))..))))))..',
  '.(((((((..((((((.......(((((((((....)))))))))....))))))(((((((((((..((....)).)))))))).))).....)))))))(((((((.(((.((((...((((((.....((((((((((.(((((((..........))))))))).)))))))).(((((((((.((.(((...(((((....(((((.....((((((..(((.((((..........((((...(((...))).))))...))))..)))..)))))))))))))))).)))...))))).)))))).))))))..((((((((((((..((.((.(((((.....))))))))).......((((((((....((((.....((((((((((((..((..(((((((............(((((((...((((.....)))))))))))))))))).)).))))).)))).)))......))))..))))))))(((......((((((......)))))).........))).))))))))))))))))...))).(((((......)))))......((....))((((...))))((((((((.((((....))))...)))))))).........)))))))....',
  '..........((((((.......(((((((((....)))))))))....))))))(((((((((((..((....)).)))))))).)))...((((((((...........)))))))).((((((.....((((((((((.(((((((..(......)))))))))).)))))))).(((((((((.((.(((......................(((((.......((((..........((((...(((...)))..))))..))))........)))))...........)))...))))).)))))).))))))..((((((((((((..(((.(.(((((.....))))))))).......((((((((....((((.....((((((((((((..((..(((((((............(((((((...((((.....)))))))))))))))))).)).))))).)))).)))......))))..)))))))).........((((((......)))))).............))))))))))))...........(((((......)))))......((....))((((...))))((((((((.((((....))))...)))))))).(((......))).......',
  '...(((((((..((((.(((..((.((((......(((...((...((((((....))))))...))..)))......))))))..))).))))..)))))))....(((...(((((.....(((((...(((..((.((.(((((...........(((((..((((.......(((.((...((.((..(((((((((((.......)))))).)))))..))))...)).))).......))))..))))).((((((....)))))).((((((((((((.......(((((.....)))))....(((((......((((((..(((((.....((....(((((((.((((((.....)))))).((((.((((.....)))).))))((((....))))...)))))))...))))))).))))))((((((....))))))....(((((..........(((...(((((((((((((...((((((.((.((.....(((((.......))))).((.(((((.((((...(((.((.(((..((((....))))..)))..((((((......))))))((((((((..(((..(((...........)))...)))......(((((((.........)))))))))))))))..)).))).))))..)).)))))......((((.(((((....))))).))))(((((.(((((.((.(((.......))).)).))....((((((((.....((((....)))).))).)))))...))).))))).)).))))))))...)))))).)))))))..)))(((((((...)))))))))))))))))))))))))......))))..))))).)).)).)))..)))))......))))).....((((((((((((...)))))))))))).)))...',
  '...(((((((..((((.(((.....((((.................((((((....))))))................))))....))).))))..)))))))...............................((((..(..((.((.......))..))...)..)))).....................(((((((((((.......)))))).))))).............((((((...))))))......((((((....))))))......((((((........(((((.....)))))...............((((((..(((((...........((((((.(((((((.....)))))).)......................((((....))))....)))))).....))))).))))))((((((....)))))).........................(((((((((((((...((((((.((.((..............................................(((..((((....))))..)))..((((((......))))))((((((((..((...(((...........)))....))......(((((((.........)))))))))))))))......................................................((((....((.((.(((.......))).)).))....(((((........((((....)))).....))))).......))))..)).))))))))...)))))).))))))).....(((((((...)))))))...........))))))...................................................((((((((((((...))))))))).)))......',
  '............(((((((((.....(((((((...)))))))((((.((((((..........(((((......((..(((((..((((.......((.((....)).)).(((((.((((.(((..(((..((((.(((..(((((((.(((.(((....))).))).)))))))...))).)))).)))..(((((.((((((((((....(((.((((.((.(((.(((((....)))))))).)).)))).)))...))))))))))..)))))(((.....)))....(((....)))..))).)))).)))))..((((((((...))))))))((((...(((........)))..)))).(((...((((.((.(((.((((((((.((((((...)))))).)))))))).)))))..))))...)))....((((......))))((((((.(((....))).))).)))))))..)))))..))....))))).((((((..(((((((...(((.(((((...(((((((.(((..((.(((((((((((((......))))))..(((((.(((((.(((((....))))).))))).))))))).))))).))....)))))))))).))))).)))..))))))).))))))..)))))))))).......(((((.((((.((((((.((.........)))))))).(((((.((.((((.......((((((((.....((((((((((...(((.((((.(((.....))))))).)))...)))))))...)))....))))).)))...)))).))..)))))..)))).)))))..(((((((....))))))).(((((((...........)))))))(((.(((.(((....((....))..)))))).))).(((((((.....))))).))))))))))).....',
  '........((((((....))))))......((((((((.....(((.((((.(((((((((.(((((((((((..((....)).)))))).((.((((.(((((.....))))).))))))..)))))))))))))).)))))))..(((((((((((.......((((.(((.((.((((....)))).))))).)))))))..))))).)))((((((((...((((.((((((.(((((((.((.(((((((..((((.((((.(((((((....))))).)))))).))))..))))))).)).))).)))).)))))).)))).......(((((((((.........))))))))).(((((((((.((.(((((.(((((.((((.....))))...))))).(((...((((.(((((((.((.(((.((.((((((.(((((...........(((((....(((((......))))).)))))...))))).)))))).)).))).)).))))))).)))).)))...............((((((((......(((....((((((..((((((((.....((.....))......)))))))).))))))))).....))))))))..((((((((.(((..((((((................)).)))).))))))))))).........((((((..(((((((...(((.((((((((((((((((.....)))))........(((..((((.(((((((((..((((((((((((.......(((.((((....((((((.....)))))).)))).)))(((((((((...((...))...)))))))))...)))))).(((((.(((((((((.((((.((..((((.(((((((((.((((..(((..((.(((....((((((((((((((...(((((((..((((((..((....))..))))))...)).)))))....)))))))))))))).....)))))..)))..))))))).))))))..)))).)).))))))))))))))))))..)))))).))))))))).)))))))))))...))))))))))..)))((((.(((((((.(((..((.......))..)))...)))))...))))))..)))))))))).(((((((((.((((((..(((((..((((((((((..(((((.......((((((((((((((.((...)).)))))))))))))))))))...)))))))....))))))))........))))))..((((((((((((((((((.....(((..((((((.....)))))).))).....)))))..))))).)))))))).))))))))).)))))..)))))))))))......))))))))......((((((((((((((((((..(((((((((((((..((((((((..........(((((((....))))))).(((((((((.((........(((((((((........)))))))))..))))))))))))))))))).)))))))))))))..))))))))..))).)))...))))...))))))))',
  '...((((((...(((((..((((((((((..((((((((.((((............((((((((....)))))))).........))))..))..))))))..)))...((((((.((((((((((((((((.(((((((((((...(((((.(((((.....))))).)))))...))))).)))))).)))))))))).)))))).((((((...((((((((.((((.......))))))))))))...))))))((((...(((((.((...)).))))).....))))(((....)))................(((((.((((((((((.(((((................................(((((((.....))))))).............((((.................)))).....(((((((((((..((((((.(((....(((((...)))))..)))..(((((........))))).....)))))).)))))))))))(((((((.((.(((.(((.....(((((.....)))))....))).))))))))))))...((..............))..........))))).....(((((.....)))))....((((((...(((((((..((((..(((((((((((((.......(((((((.....(((((((...)))))))..))))))).((((((((...((...))...))))))))....)))))).((((((..(((((((((((....(((.(((((...((((.(((((..((.((.(((((...((((((((((((.....(((((((((((.(((((((....))))))).)))))))))))......)))..)))))))))....))))).)).)).)))))))))....))))))))....))))))))))).))))))..)))))))..)))).)))))))...)))))).........(((.....(((...)))...)))...............))))))))))..)))))................................))))))....((((((((((((((.......(((((((((((((((((.......)))))))))))))))))))))).))))))))).)))))))..)))))......))))))((((((.((((((......((((((((((((((((....))))...)))).))))))))))))))..))))))...',
  '...((((((..((((((..((((((((((..((((((((.((((......((((..((((((((....)))))))).....))))))))..))..))))))..)))...((((((.((((((((((((((((.(((((((((((...(((((.(((((.....))))).)))))...)))).))))))).)))))))))).)))))).((((((...((((((((.((((.......))))))))))))...))))))((((...(((((.((...)).))))).....))))(((....))).(((.((.((((((......(((.((((.(((....((((......))))....(((((((((((((((..((((((((((.(((....)))((((((....((((...(((........))))))).....(((((((((((..((((((((((....(((((...)))))..)))).(((((........))))).....)))))).)))))))))))(((((((.((.(((.(((.....(((((.....)))))....))).))))))))))))..((((.((......)).)))).....((((.((((.....(((((.....)))))....((((((...(((((((..((((..(((((((((((((.......(((((((.....(((((((...)))))))..))))))).((((((((...((...))...))))))))....)))))).((((((..(((((((((((....(((.(((((...((((.(((((..((.((.(((((...((((((((((((.....(((((((((((.(((((((....))))))).)))))))))))......)))..)))))))))....))))).)).)).)))))))))....))))))))....))))))))))).))))))..)))))))..)))).)))))))...))))))....)))))))).....(((...)))..))))))....))))))))))....)))))))))))))))))).))))))))))))).))...)))...))))))....((((((((((((((.......(((((((((((((((((.......)))))))))))))))))))))).))))))))).)))))))..))))...))..))))))((((((.((((((......((((((((((((((((....))))...)))).))))))))))))))..))))))...',
  '((.(((((((....((......))...)))))))(((((((((........)))).))))).((((((((((((((.(((((((((((.((((((..(((((((((((........)))(((((((.....))))))).((((((....))))))....((.((((((.....((((((((..................)))))))).....)))))))).(((((..(((((((.(((.(((.(((....))).)))..))).)))))))..)))))((.(((.....)))))((((((((..(((.........))))))).)))).((((((.....(((((........))))).(((((((..((..(((.....)))))..))))))).))))))..(((((((((((((..(((((........((.((((((((((((.....)))))....((((....)))).))))))))))))))..))).))..))))))))....)))))))).))..((((.........)))).......)))))))......)))))))).)))....((((((((..((((((((((........)))))....)))))(((((..((((((....)))))))))))...........((((((.....)))))).(((..(((((.((...))))))).)))..(((((.....))))).)))))))).......)))))(((((...........)))))........(((.((((............)))).))))))))).................((((((.((....)).))))))))..',
  '........................((((((.(((((...(((..(((((...))))).)))..)))))....(..((((((.(((...))).)))))).......).((((....))))(((((((.....)))))))......((((((........))))))..)))))).((((((((..................))))))))......................................((....)).........................((.(((.....))))).((((((.(((.((((..((((...)))).)))).((((((.....(((((........))))).(((((((..((..(((.....)))))..))))))).)))))).........((((((..(((((..................(((((.....)))))....((((....))))..........)))))..))).))).............)))..)))))).................................................................((((((((((........)))))....))))).......(((((......)))))................((((((.....))))))......(((((.((...)))))))......(((((.....))))).................................................((((.((((............)))).))))......................((((((.((....)).))))))....',
  '.........(((((((....))...)))))....((((((((..((((((.....((((((((.....))))))))..........))))))((.(((((((((.((((((...........((((((......)))))).))))))..)))...))))))))(((((((((((.((....)).))))(((((..........)))))........)))))))))))))))..(((...((((((........((((((((..............)))))))).....))))))....)))......',
  '.........(((((...........)))))....((((((((..((((((.....((((((((.....))))))))..........)))))).(.(((((((((.((((((...........(((((........))))).))))))..)))...))))))).(((((((((((.(......).))))(((((..........)))))........)))))))))))))))..(((...((((((........((((((((..............)))))))).....))))))....)))......',
  '.............(((.(((....((((.((((.(((...((((((..(((.(((........((((((((..((((......(((((.......)))))((((((((((..((((.(((((((((.....)))).))))))).))((((((((.(((.......(((((((......)))))))..(((((((((((((......)))).....((((((((...))))))))........((...((((.((((....(((((...)))))..)))).))))....)).((..((((((.....))))))..))((((((..(((..((.(((.(((.(((((.((((((.......(((.(((...))).)))......)))))).))))).))).)))))..)))......)))))).....(((((((.((((((....)))..))).))))))).....)))))))))((((.((.(((((..........)))))..))))))((((((.....((((((.......))))))..))))))(((((.....))))).....((((((((.....))))))))(((((((.......)).)))))(((.(((((((((((((((((((((((....((((.((((((.(((((..(((..(((((....(((....)))..((((.((((.((((((((((((..((((.(((.....))).))))((((((((....)))).))))......((((((((((.......)).))).)).))))))))))))))))))).))))))).))..)))))).)).)))))))).))..(((((((....))))))).)))).)).)))).))).....(((.((.(((((((((.........))))))))).)).)))......))))))))))))).((((((((((((((....((((....)))).(((((....)))))...)))))))..))))))).....(((((.......)))))..(((.((((((((((((.........)))....))))))))).))).))).))))))))....))))))))))....)))).))))))))..........))))))..)))).))...))).)))))))).......))).)))...',
  '((((..(((..((((.(((((...(((((..(((((((........))))((((((((.((.............))..))))))))..(((((...((((((..((..((((((((......(((((((((((((.......)).)))))))....)))).........))))))))(((((.......)))))(((((....)))))....(((((((((....(((((.(((((((.....(((((((.(((((((..((((.............))))..))))).(((((((....(((.......)))...)))))))..((((((....(((((.....((((((((......)))).))))))))).))))))....))..))))))))))))))....))))).....((((((((((((((((..........)))))..)))..))))))))......(((..((((..((((...))))..)))).)))..))))))))).....))))))))...))))).....))).)))))....))))).((((.....(((((((......))))))))))))))).)))..))))....',
  '((((..(((..((((.(((((...(((((..(((((((........))))((((((((.((.............))..))))))))..(((((...((((((..((..((((((((......(((((((((((............)))))))....)))).........)))))))).((((.......)))).(((((....)))))....(((((((((.....((((.(((((((......((((((...(((((..((((.............))))..))))).(((((........................)))))..((((((.(..(((((.....((((((((......)))).))))))))))))))))........)))))).)))))))....))))......((((((((((((((((..........)))))..)))..)))))))).........((((((..((((...))))..)))).))...))))))))).....))))))))...))))).....))).)))))....)))))..........(((((((......)))))))....)))).)))..))))....',
  '......(((((((((.....((..(((...((.((((.((.((((((...........)))))).)))))).)).)))..)).(((((....))))).......((((....(((((((....)))))))....))))))))))))).....((((((..............)))))).',
  '.......(((((((.((((((((((.(((................))))))..)))))))..((((((..((..((((....((((((((((.....((....)).....(((((.((....))))))).....((((((((...))))))))((((((((..((((.......))))..)).))))))(((.((.(((..((....(((((...((((((((((..........)).)))))).))....)))))..))))).)).))).....(((((((.....)))))))..))))))))))....))))..)).)))))).......((((((...))))))(((((((((((((.((((...)))).)))))......))))))))...(((((.(((....((((.....)))).((((.((((..((........((((((.......))))))..)).))))..))))...((((.(((((((((.......(((((((((....(((...(((((....))))).)))..)).)))))))..((((.((((.......((((..((((.....)))).)))).((((((((.((((....((((((((.((....)).))))))))..))))))))..))))((((((.....))))))((((.(((((((.....)))))))))))((((((.(((((............))))))))))).)))).)))).))))......))))).))))))).))))).))))))).......(((..(((((.......))))))))...((((((((.((....))))))))))....',
  '.......(((((((.((((((((((.(((................))))))..)))))))..((((((......((((....((((((((((.....((....)).....(((((.((....)))))))......(((((((...))))))).((((((((..((((.......))))..))).)))))............(((......)))....((((((...............))))))................((((((...))))))(((((((.....)))))))..))))))))))....)))).....))))))......................(((((((((((((.(((.....))).)))))......))))))))...(((((..((....((((.....))))......................((((((.......)))))).......................................((((((.....................................))))))..((((.((((.......((((..((((.....)))).)))).((((((((.((((....((((((((..........))))))))..))))))))..))))((((((.....))))))((((.(((((((.....)))))))))))(((((.((((((............))))))))))).)))).)))).....................))..))))).)))))))............(((((.......)))))......((((((((.(......)))))))))....',
  '.....(((((((..((.(((....((((((....))))))..))).))))).))))((((((((.(((((.((((((.((......))...((.(((.....)))))..........(((((((((((....))))))).))))))))))(((((.((.((((((...((.(((((....(((((............(((((((((....))).....(((.((((.....)))).)))))))))...)))))...))))).))....)))))).))..)))))..((((((.......))))))((((((.........)))))).....(((......))).))))))))))))).....',
  '.....(((((((..((.(((.....((((......))))...))).))))).)))).(((((((.((.(((((((((..............((.(((.....)))))..........(((((((((((....)))))))).)))))))))......................................................((....)).......((.((((.....)))).)).................................................(((((.......))))).((((((.(......)))))))...............)))...)))))))))......',
  '............(((((...............((((.(((((((((((........)))..(((((.....((((((((.(((((........)))))...((((..((......))....))))...(((((((((((.((((.(((.(((((((.....)))))))((((((.(((((((((((((((((..((((......))))))))..((.(((((((((.((((..(((.(((((.(((.(((...)))))).((((.(((((....)))))))))(((((((((..(((.......))).))).))))))))))))))..))))..)))).)))))..))...((((.(((.((.......)).))).....(((.((((..((((...))))....)))).))).......))))((((((.(((..(((.(((((...))))).)))..)))))))))))).))))............(((((.(((((...(((.(((((.((......)).))))))))...))))).)))))))))))..))))))............((((((........))))))....))))))).))......))))).))))))))))...)).....)))))...))))))))..)))).....(((((..((.((((.........)).))..)).)))))..((((((.(((..........((.((((..((((((((...((......))..))))))))..)))).))...(((...(((((((........))))))).))).....(((......))).(((((........)))))(((((((((.........))))))))).....((((.(((((......(((....)))......))))).)))).))).)))))).....(((((((((((.....)))))))))))))))).',
  '............(((...................(..(((((((((((........)))..(((((.....((((((((..((((........))))......(((..(......).)))........(((((((((....(((.((..(((((((.....))))))).(((((.(((((((((((((..................((((((.....(((((((((.((((..(((.(((((..................((((.(((((....)))))))))(((((.(((..((.........)).)))..)))))))))))))..))))..)))).)))))....................................(((.((((..((((...))))....)))).))).....))))))(((((.((((..(((.(((((...))))).)))..)))))))))))).))))............(((((.(((((...(((.(((((.((......)).))))))))...))))).)))))))))))..)))))...........(.((((((........)))))).)...)))))..........))))).))))))))))...)).....)))))...))))))))...).......(((((..((.((((.........)).))..)).)))))..((((((.(((..........((.((((..((((((((...((......))..))))))))..)))).)).........(((((((........))))))).........(((......))).(((((........)))))(((((((((.........))))))))).....((((.(((((......(((....)))......))))).)))).))).)))))).........(((.............)))......))).',
  '(((...(((((.(((((.....))))).)))))...)))...(((((((((((((((((((((...(((((((...((((((((.((((.......))))))))))))...)))))))))))).(((((.((...)).)))))....)))))).))...(((((...((((((.(((..((((((.....(((.....((((......)))).....)))............(((((((.....))))))))))))).)))))))))....)))))..................))))))))...((((........))))(((((...)))))...((..(((((........))))).))....',
  '............(((((.....)))))...............((((((..(((((((((((((...(((((((...((((((((.((((.......))))))))))))...)))))))))))).(((((.((...)).)))))....)))))).))...(((((...(((((..(((..((((((.............((((......))))....................(((((((.....))))))))))))).))).)))))....)))))....................))))))...((((........))))................((..(((((........))))).))....',
  '((((.((((((.(((...((((((((...(((((((.....(((((.(((((((.(((((.((.(((((((((........(((((((....)))))))....((((((((...........(((((((........)))))))...))).)))))..)))))))))))))))).))))))).))))))))))))....))))))))..))).))))))..))))((((.......))))((((((((.((((.(((((.(((.(((.((((((....)))))).))).)))..)))))..)))).(((((((((((((..(((..((((((((..(((.(((((((((......))).))))))(((((((((((.....((.(((((((...)))))))((((...)))).........)).....)))))))))))..)))..))))))))..)))...))))))).))))))..))))))))....((((((...((.((((((((((((((....)))))))).))))))))...))))))',
  '.......(((((((((((.....(((((.......)))))..))))))))))).....',
  '.....(((((((...(((((..(((((((...((((.(((((..(((.(((...((((........)))).))).)))))))).))))..)).))))).....(((((..........)))))....(((((((((....))).)).)))).((((......))))..)))))..)))))))................(((((((((..((......((((((.((((((((.(((.(((..((((.((((.....((((....))))......)))).))))..)))))).))..))))))..)).)))).(((((......))))).((((((((.........)))))))).))..)).)))))))..(((((((((((.....(((((.......)))))..))))))))))).....',
  '.....(((..(((((..((((.((.((.(((..(((((....))))).))).)).)).))))...((((((((((((((((((((((.(((((((...((((((((((((((.......(((((((((((((((((.......)))))))))))))))))))))).))))))))).....)))))))..)).)).)).....((((((.((((((......((((((((((((((((....))))...)))).))))))))))))))..))))))..))))))))..((((.......))))((((((.(((...((((((((...(((((((.....(((((.(((((((.(((((.((.(((((((((........(((((((....)))))))....((((((((...........(((((((........)))))))...))).)))))..)))))))))))))))).))))))).))))))))))))....))))))))..))).))))))....((((((.......)))))).......((((.(((((.(((.(((.((((((....)))))).))).)))..)))))..))))...))))))))((((.((((.......)))).))))...(((((......))))))))))...))).((((...(((..(((((((...)))))))..)))...)))).............',
  '.............((((((....((((....))))..))))))........((((((.(((((...(((((..........(((((..(((((((.(((((((((((((((...)))))..)))).((((.(((.((((.....))))))).))))..)))))))))))))..)))))....(((((((.((((......((((..((((((((....)))))))).....))))))))..)))).)))))))).)))))((((..((((((((((((((((.(((((((((((...(((((.(((((.....))))).)))))...)))).))))))).)))))))))).))))))..)))).....(((((((.((((.......)))))))))))((((((((((((((...(((((.((...)).))))).....)))))..))..))).))))...........((((((((((((((((((((((((.(((.....(((((((((............(((((((.....)))))))..)))).))))).((((...(((........))))))).....(((((((((((..((((((((((....(((((...)))))..)))).(((((........))))).....)))))).)))))))))))(((((((.((.(((.(((.....(((((.....)))))....))).))))))))))))..((((.((......)).))))...))).))))))))....(((((.....)))))....((((((...(((((((..((((..(((((((((((((.......(((((((.....(((((((...)))))))..))))))).((((((((...((...))...))))))))....)))))).((((((..(((((((((((....(((.(((((...((((.(((((..((.((.(((((...((((((((((((.....(((((((((((.(((((((....))))))).)))))))))))......)))..)))))))))....))))).)).)).)))))))))....))))))))....))))))))))).))))))..)))))))..)))).)))))))...)))))).((((((..(((.....(((...)))...)))..))...))))....)))))))))).))))))))))))...(((((.((((((((((..(((.....))).....)))..))))))).)))))',
  '.............((((((......(......)....))))))...............(((((...(((((........(.(((((..(((((((.(((((((((((((((...)))))..)))).((((.(((.((((.....))))))).))))..)))))))))))))..))))))...(((((((.((((............((((((((....)))))))).........))))..)))).)))))))).)))))......((((((((((((((((.(((((((((((...(((((.(((((.....))))).)))))...))))).)))))).)))))))))).))))))...........(((((((.((((.......))))))))))).((((((..(((((...(((((.((...)).))))).....)))))......))).)))............(((((.((((((((((.(((((((..((..........................(((((((.....))))))).............((((.................)))).....(((((((((((..((((((.(((....(((((...)))))..)))..(((((........))))).....)))))).)))))))))))(((((((.((.(((.(((.....(((((.....)))))....))).)))))))))))).........................))..))))))).....(((((.....)))))....((((((...(((((((..((((..(((((((((((((.......(((((((.....(((((((...)))))))..))))))).((((((((...((...))...))))))))....)))))).((((((..(((((((((((....(((.(((((...((((.(((((..((.((.(((((...((((((((((((.....(((((((((((.(((((((....))))))).)))))))))))......)))..)))))))))....))))).)).)).)))))))))....))))))))....))))))))))).))))))..)))))))..)))).)))))))...)))))).........(((.....(((...)))...)))...............))))))))))..)))))..........(((...(((((............................)))))...))).',
  '..(((..(((.((..((((((..(((((((...(((.(((((...(((((((.(((..((.(((((((((((((......))))))..(((((.(((((.(((((....))))).))))).))))))).))))).))....)))))))))).))))).)))..))))))).)))))).(((((.((((........(((((.((((.((((((.((.........)))))))).(((((.((.((((.......((((((((.....((((((((((...(((.((((.(((.....))))))).)))...)))))))...)))....))))).)))...)))).))..)))))..)))).)))))..(((((((....)))))))...)))).))))).......((.((((((.....))))))...))...(((((.((((((..((...))..))))))....))))))).))).)))',
  '((((....))))...((((.(((((((((.((((.((..((((.(((((((((.((((..(((..((.(((....((((((((((((((...(((((((..((((((..((....))..))))))...)).)))))....)))))))))))))).....)))))..)))..))))))).))))))..)))).)).)))))))))))))))))(((.((..((((....((.((((......)))).)).............((((.(((((((.(((..((.......))..)))...)))))...))))))......((((((...........))))))))))..)))))............',
  '...((((((((((..((((((..((((....)))).((((((((((((((..(((((((((((((..((((((((..........(((((((....))))))).(((((((((.((........(((((((((........)))))))))..))))))))))))))))))).)))))))))))))..))))))))..))).)))........)))))).)))).))))))((((.....))))(((((.((((((((.((.(((((.((....))..)))))))..........(((((..((((((......(((...)))..))))))))))))))))))).)))))(((((....)))))..',
  '....(((.(((((........((((.(.((((((..(((.(((....))))))....)))))).).))))(((((((.((((((((.........))))))))))))))).))))).)))',
  '........(((((....(((((..((((((.....)))...((((....((((((((....))))))))))))...(((((((.....((((((.((.((....)))).))))))...............)))))))....(((((.(((...))).))..))))))..)))))..(((((((((((((.....((.((..........))))))))))))))))))))))......................(((((((((((((((............))))).((((.((((((.......))).)))...))))((((((((((..............))))))))))...((((..((.....)).))))((((....)))).......(((((....)))))...((((.......)))))))))))))).........((((((((......)))))))).....(((((((......)))))))..',
  '........(((((....(((((..(((..............((((....((((((((....))))))))))))...(((((((.....((((((.((.........)).))))))...............))))))).......((.(((...))).)).....)))..)))))..(((((((((((((........................))))))))))))))))))......................(((((((((((((((............))))).((((.((.(((.......)))..))...))))((((((((((..............))))))))))....(((............)))..............(((...(((((....))))))))..((.......))..)))))))))).........((((((((......)))))))).....(((((((......)))))))..',
  '.........((((.((((((.......))))))..))))...........(((((.............))))).....(((((..(((((.((((((((.....))))..)))).))))).)))))......(((((.((((((.(((.((......))...))).)))).)))))))..',
  '.........((((.((((((.......))))))..))))..............................((((((.((....)).)))))).......((((.....)))).....................(((((.((((((.(((.((......))...))).)))).)))))))..',
  '........(((((((.......)))))))...((((((((.((((((((......(((.((((...................)))).)))......))))))))....))))))))..........((((.((((....(((((....(((((.((((((((((((.((((((((............))))))))..........)))))))).......((((((((((((((((......))))))))).....((((....)))))))))))...............)))))))))...)))))...))))...))))......(((((((((..((.(((......))))))))))..))))..',
  '........(((((((.......)))))))...((((((((.((((((((......(((.((((...................)))).)))......))))))))....))))))))...............((((....(((((....((((.(((((((((((((.((((((((............))))))))..........)))))))).......((((((((((((((((......))))))))).....((((....)))))))))))...............)))))))))...)))))...)))).............(((((((((..((.(((......))))))))))..))))..',
  '......((((((((((..............))))).))))).....................((((((..((.............))..))))))..((((((....(((((((........(((((((...)))))))........)))))))....)))))).((((......)))).',
  '.......(((((((((..............))))).))))......................((((((..((.............))..))))))..((((((....(((((((........(((((((...)))))))........)))))))....))))))................',
  '((((((...((((((..............(((((((.(((.(((((........)))))..)))))))))).......))))))..(((((((..........))))))).....((((.((......)).))))...........................((((.(((..((((((....))))))..))).))))((..(((.((...((((((((((...)))))))(((((((..(((((.....))))))))))))...............)))...)))))..)).......))))))...',
  '((((((...((((((..............(((((((.(((.(((((........)))))..)))))))))).......))))))..(((((((..........)))))))..........((......))................................((((.(((..((((((....))))))..))).))))................(((((((...)))))))(((((((..(((((.....)))))))))))).....................................))))))...',
  '...((((.........)))).((((((((((((((....))))))((((...((((....))))..))))..((((.((......)))))).(((.((((...))))..)))((((((((((.......................))))))))))((((((..((..((..(((.((..(((((((((.((....)).)))))))))..)).)))..))..))))))))..(((((((....((.....))....)))))))....(((((....))))).))))))))..((((...))))..',
  '(((((((((.....(((((((.............((((..(((....((((...))))...)))..))))...((((.....)))).)))))))((((((((((((((..((((((...))))))))))))))...)))))).((((((((.........((((.((((((((...)))).)))).))))....))))))))((((((((((..((((((((((((((((......))))))))..))))))))....))).....(((((.(((((((((..........)))))))))))).))......((((.((((.......(((((...))))).....)))))))).)))))))((((((((((...........))))))))))..))))....)))))..((((.((((.((((....))))...)))).))))..(((((.(((..............))))))))..',
  '..................................((((............................))))........................((((((((((((((..((((((...))))))))))))))...))))))..................((((.((((((((...)))).)))).))))........................((((((((((((((((......))))))))..))))))))................(.((((((((............))))))))).............................................................((((((((((...........))))))))))..................(((.((((.((((....))))...)))).))).........(((..............))).......',
  '...((....)).((((((.(((((.((.(((((((((......)))).))))).))))))).((((.(((((((((((........)))))..)))))).))))((((((((((....)))).)))))).....((((............))))......(((((((.......(((((((......))))))).....((((......)))))))))))...............((((((((..((..............((((((((((((((....))))))..))))))))...........((((((.....(((......)))..)))))).....)).)))))))))))))).....',
  '(((((.......)))))......................................((((((((...((((((....((((.............((((((...(((((.((((.(((((.......))))).)))).)))))..)))))).((((((.....((((((((.(((((....)))))...)))).)))).))))))............((((((.(((((((((((....)).))).)))))).))))))............((((..................)))).........(((((((((...((....))....))))))))).......))))...))))))))))))))',
  '(((((.......)))))........................................(.............................).......((((...(((((.((((.(((((.......))))).)))).)))))..))))...((((((.....((((((((.(((((....)))))...))))).))).))))))............((((((.(((((((((.........))).)))))).))))))............((((..................)))).........(((((((((...((....))....)))))))))............................',
  '.(((((...(((((((...(((((((...(((((((((.((.(((....))).)))))))))))....))))))).....))))))).........(((((((((((..((.(((..(((......)))))).))..)))).))))))).......(((..(((...((((((((.(((.((((.(((....))))))).)))((((((((.............((((..(((....((((...))))...)))..))))...((((.....)))).)))))))))))))))))))..))))))))..',
  '..(((....(((((((...(((((((...(((((((((.((.(((....))).)))))))))))....))))))).....))))))).........(((((((((((..((..((...((......)).))..))..)))).)))))))............(((...((((((((.(((.((((.(((....))))))).)))((((((((.............((((..(((....((((...))))...)))..))))...((((.....)))).)))))))))))))))))))......)))...',
  '(((....((((((...))))))...)))...........((((((...((((((.((((((((.(((((((((............(((......))).((((...((.((((((((((.(((((((((((.....(((((...(((((.....)))))....)))))...))))))))))))))))))))).)).)))))))))..(((.(((((((((......)))).))))).))))))).)))))))).)).))))...))))))..((((((((.(((.((((((((((((.(((..(((((((......))).))))...)))))))))).)))))(((((((.......(((((((......))))))).....((((......))))))))))).........))).))))))))..',
  '.........................(((.(((......))).))).................((((..(((((.............(((((((((..........((.((((((((((.(((((((((((.....(((((((.(((((.....))))).)).)))))...))))))))))))))))))))).))........(((.(((.(((((((((......)))).))))).))))))....((.(((((((((((........)))))..)))))).))..........................................))))))))).............)))))...(((((((......)))))))...............))))..............................',
  '...(((((((.((((..((((((((..................))))))))......)))).))))))).......(((..((((..(((((((((.((((...........))))))))).)))).....)))).)))..((((((....(((((.((((...)))).)))))..((((((..(((((((((....)))))))))....))))))...((((((......)))).))((((((((((((...))))))).))))).(((((.(((((((((((((...(((.((.....)).)))...)))))))(((((.((.(((((.((.((....)).)).))))).)).)))))....)))))).))))).((((......(((.....)))......))))((((....))))((((.(((((..(((.......)))..)))))..))))....((((.....))))...))))))',
  '.((((((......)))))).............................(......)............((........)).......................................................................(((((.((((...)))).)))))..((((((..(((((((((....)))))))))....))))))...((((((......)))).))((((((((((((...))))))).)))))...................................................(((.....((((..((.(......).))..)))).....))).............................................................((((.(((((..(((.......)))..)))))..))))....((((.....)))).........',
  '....((((((....))))))(((((((.....(((.((.((..(((((((((((..........(((((....)))))(((((((.(((((..(((..(((..........))))))...))))))))))))(((((.....))))).))))))))))).)).)))))...(((((.........)))))((((...))))......))))))).((((.....))))............',
  '.....((((......)))).(((((((.........((.((..(((((((((((..........(((((....)))))(((.(((((......(((..(((..........)))))).........)))))..)))............))))))))))).)).)).......((((.........)))).((((...))))......)))))))..........................',
  '((((((.......................))))))....(((((((((((((((.......(((.((((...)))))))........((.(((.......))).))(((((.......)))))......(((((..(((.(((......((((..((((........))))...)))).......(((.((((((...)))))).)))..((((.......)))).))).))))))))....(((((((((...)))))))))...........(((...)))..))))))))))....)))))....',
  '((((((.......................))))))....((((.((((((((((.......(((.((((...)))))))........((.(((.......))).))(((((.......)))))......(((((.....................((((........))))...............((.(((((.....))))).))...((((.......))))........)))))....(((((((((...)))))))))......................)))))))))).....))))....',
  '((((((....)))))).((((((....))))))....((((((((((((.((....((((((((((((((((((...........((..((((((((((......((((((...))))))....))))))))))..)).....(((((.((((((((.(((((.....))))))))))))))))))))))...)))))))))))))))).)))))..............))))..))).....((((.((((...((..(((...(((((.(((((.(((............))).))))))))))...)))..))...((((..((((((((((...)))))))))).)))).)))).))))',
  '(((((......))))).((((((....))))))....(((((((((((..((....(((((((((((((((((((..........((..((((((((((......((((((...))))))....))))))))))..))......((((.((((((((.(((((.....))))))))))))))))))))))...))))))))))))))))..)))..............))))))..))......(((.(((....((..(((...(((((.((((....................))))..)))))...)))..))...((((..((((((((((...)))))))))).))))..))).))).',
  '....(((((((((((((.(((((((..........)))).......))).))))....(((((.....)))))....)))))).)))((((((..((((..(((((((((((((.(((...(((((((.....(((((.......)))))..))))))).((((((((...((...))...))))))))))).)))))).((((.((.(((((((((((....(((((((((...((((.(((((..(((((.(((((...((((((.((((((.....(((((((((((((((((((....)))))))))))))))))))......)))))).))))))....))))).))))).)))))))))....)))))).)))..))))))))))).))))))..)))))))..)))).))))))..',
  '...(((((.(((.(((.((.......)).))).)))...((.((.(((.((((((.......))))))..))).)).))(((((((......))).))))((((..(((.((((.((((..(((((.....)))))..)))).)).)).))).))))...)))))((((...))))......',
  '.............................................(((.((((((.......))))))..)))......(((((((......))).))))...............((((..(((((.....)))))..))))...((((.......))))......................',
  '....((((...(((...............)))...)))).........................((((...........))))((((.(((((.(((((((...(((((.(((.((((((....))))))..))).)))))...))))))).))))).))))((((((((((....(((((((((((((((..((((....))))))))))).))))))))...))))))))))........',
  '....((((...(((...............)))...))))...........................................(((((.(((((.(((((((...(((((.(((.((((((....))))))..))).)))))...))))))).))))).))))).((((((((....(((((((((((((((..(((......)))))))))).))))))))...))))))))..........',
  '......(((((((...)))))))....((.(((((...)))))))....',
  '.((((.(((.((((.(((((.(((((...)))))(((((.(((((((((....((((((((....)))))..)))....((((.(((((((((((........))))))))))).))))(((....((..(((((..(((((...........(((((..(((((((.(((((((((((((((...)))))..)))).((((.((((((((...)))))))).))))..)))))))))))))..)))))....(((((((.((((......((((.((.(((.((((.....)))).)))))))))))))..)))).)))))))))))))..)))))((((((((((((((((.(((((((((((...(((((.(((((......))))).)))))...)))).))))))).))))))))))).))))).((((((....(((((..(((((.........))))))))))....)))))))))))).(((((.((...)).)))))....((((...))))))).))))).................((((((((((...))))....((((((.....((.......)).....)))))).......))))))....)))))))))..))).))))......((((.(((.(((((((((((...((((((((((....(((((((....)))))........((((........))))..)))))))))).)).)))))))))((((..((((.(((.(((....((((((.....))))))...))).)))))))...))))((((..........)))).....)).))).)))).........',
  '.((((.(((.((((.(((((.(((((...)))))(((((.(((((((((....((((((((....)))))..)))......((.(((((((((((........))))))))))).)).........((..(((((..(((((.........(.(((((..(((((((.(((((((((((((((...)))))..)))).((((.((((((((...)))))))).))))..)))))))))))))..))))))...(((((((.((((......((((.((.(((.((((.....)))).)))))))))))))..)))).)))))))))))))..))...((((((((((((((((.(((((((((((...(((((.(((((......))))).)))))...))))).)))))).))))))))))).))))).((((((....(((((..(((((.........))))))))))....)))))))))))).(((((.........)))))....((((...))))))).))))).................((((((((((...))))....((((((.....................)))))).......))))))....)))))))))..))).))))......((((.(((.(((((((((((...((((((((((....(((((((....)))))........((((........))))..)))))))))).)).)))))))))((((..((((.(((.(((....((((((.....))))))...))).)))))))...))))(((((.......).)))).....)).))).)))).........',
  '..............((((((.....(((((((((.(((....)))..)))....((((((.((((.(((.((((...)))))))...))))..)))))).......(((((...(((((((((.((......(((((.....(((.............((((.(((((((.((.(((....))))).)))))..)).))))..))))))))......)).)))))))))..............)))))))))))........))))))((((...........)))).(((.....)))...',
  '..............((((((...........(((.(((....)))..)))....((((((.((((.(((.((((...)))))))...))))..))))))....((.(((((...(((((((((.((.........((...((((((................((.(((((.((.(((....))))).))))))).........)))))).)).....)).)))))))))..............))))).))...........))))))((((...........)))).(((.....)))...',
  '....(((((((..((((.(((((..............))))).)).))....))))))).....(((((((((((....))))..((((.((((((......))))))((((((((..(((..(((...........)))...)))......(((((((.........)))))))))))))))...((.(((((((..(((((((....((.((((.(((((....))))).)))).)).....(((.((.(((.......))).)).)))......(((...(((.((((....)))).)))..)))(((((..((.....)).))))))))..))))..))))))).))))))(((((((...)))))))...(((((...((......((((.........))))......))...)))))................((((((((((((...)))))))))))))))))))',
  '....(((((((..((((.(((((..............))))).)).))....))))))).....(((((((((((....))))..(((..((((((......))))))((((((((..((...(((...........)))....))......(((((((.........)))))))))))))))...((.(((((((..(((((((.....(.((((.(((((....))))).)))).)......(((.((.(((.......))).)).)))....((((........((((....)))).....)))).(.((..((.....)).)).).)))..))))..))))))).)).)))(((((((...)))))))........................((((..((.....(((((....)))))...)).)))).......((((((((((((...)))))))))))))))))))',
];

describe('`arrange()` function', () => {
  test('smoke test', () => {
    expect(randomStructures.length).toBeGreaterThanOrEqual(75);

    shuffled(randomStructures).slice(0, 10).forEach(dotBracket => {
      let [seq, basePairs] = StructureMock.fromDotBracket(dotBracket);

      // runs without throwing
      arrange(seq, basePairs, {
        spacing: 20 * Math.random(),
        basePairSpacing: 20 * Math.random(),
        hairpinLoopSpacing: 20 * Math.random(),
        terminiGap: 20 * Math.random(),
      });

      // arranges the bases into a valid layout
      expect((new Layout(seq)).isValid()).toBe(true);
    });
  });

  test('an empty structure', () => {
    let [seq, basePairs] = [[], []];

    expect(() => arrange(seq, basePairs, { spacing: 1 })).not.toThrow();
  });

  test('a structure with only one base', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('.');

    expect(seq.length).toBe(1);
    expect(basePairs.length).toBe(0);

    arrange(seq, basePairs, { spacing: 2 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  test('a structure with no base-pairs', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('......................................');

    expect(seq.length).toBe(38);
    expect(basePairs.length).toBe(0);

    arrange(seq, basePairs, { spacing: 2 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  test('a hairpin', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('((((((.....))))))');

    expect(seq.length).toBe(17);
    expect(basePairs.length).toBe(6);

    arrange(seq, basePairs, { spacing: 3 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  test('a one base-pair stem', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('..(....)....');

    expect(seq.length).toBe(12);
    expect(basePairs.length).toBe(1);

    arrange(seq, basePairs, { spacing: 1.5 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  test('a structure that is just one base-pair', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('()');

    expect(seq.length).toBe(2);
    expect(basePairs.length).toBe(1);

    expect(basePairs[0][0]).toBe(seq[0]);
    expect(basePairs[0][1]).toBe(seq[1]);

    arrange(seq, basePairs, { spacing: 8 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  test('hairpins with small loop sizes', () => {
    let structures = [
      '(((())))',
      '((((.))))',
      '((((..))))',
      '((((...))))',
    ];

    structures.forEach(dotBracket => {
      let [seq, basePairs] = StructureMock.fromDotBracket(dotBracket);

      arrange(seq, basePairs, { spacing: 20 * Math.random() });

      expect((new Layout(seq)).isValid()).toBe(true);
    });
  });

  test('linkers with small numbers of unpaired bases', () => {
    let structures = [
      '((((....))))((((....))))',
      '((((....)))).((((....))))',
      '((((....))))..((((....))))',
      '((((....))))...((((....))))',
    ];

    structures.forEach(dotBracket => {
      let [seq, basePairs] = StructureMock.fromDotBracket(dotBracket);

      arrange(seq, basePairs, { spacing: 20 * Math.random() });

      expect((new Layout(seq)).isValid()).toBe(true);
    });
  });

  test('a pseudoknot', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('.................................');

    expect(seq.length).toBe(33);
    expect(basePairs.length).toBe(0);

    // stem 1
    basePairs.push([seq[2], seq[15]]);
    basePairs.push([seq[3], seq[14]]);
    basePairs.push([seq[4], seq[13]]);

    // stem 2
    basePairs.push([seq[6], seq[29]]);
    basePairs.push([seq[7], seq[28]]);
    basePairs.push([seq[8], seq[27]]);
    basePairs.push([seq[9], seq[26]]);

    arrange(seq, basePairs, { spacing: 2.5 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  test('a structure with unsorted base-pairs', () => {
    let [seq, basePairs] = StructureMock.fromDotBracket('.....((((..(((.((((........)))).))).)))).((.........))...');

    // make unsorted
    basePairs = shuffled(basePairs);

    arrange(seq, basePairs, { spacing: 2 });

    expect((new Layout(seq)).isValid()).toBe(true);
  });

  /**
   * Creates some sample layouts using the `arrange()` function
   * and writes them to a specified directory
   * as CSV files that can be opened in a program like Excel
   * and viewed as scatter plots with the points connected by lines.
   */
  /*test('viewing some sample structures', () => {
    let directoryPathToWriteSampleLayoutsTo = 'src/sample-layouts/';

    let numSampleStructures = 20;

    let sampleStructures = shuffled(randomStructures).slice(numSampleStructures);

    sampleStructures.forEach((dotBracket, i) => {
      let [seq, basePairs] = StructureMock.fromDotBracket(dotBracket);

      // test handling of unsorted base-pairs
      basePairs = shuffled(basePairs);

      arrange(seq, basePairs, { spacing: 5, basePairSpacing: 5, hairpinLoopSpacing: 2.5 });

      let layout = '';

      seq.forEach(b => {
        let { x, y } = { ...b.getCenterPoint() };
        layout += `${x},${y}\n`;
      });

      let layoutFilePath = directoryPathToWriteSampleLayoutsTo + `sample-layout-${i + 1}.csv`;

      fs.writeFileSync(layoutFilePath, layout);
    });
  });*/
});
